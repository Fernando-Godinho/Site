{% extends 'website/base.html' %}
{% block content %}
<section class="py-20" x-data="fadeIn">
  <div class="mx-auto lg:container max-w-[var(--container-max)] px-6">
    <div class="grid grid-cols-2 gap-12 items-center">
      <div class="rounded-lg overflow-hidden">
        <img src="https://images.unsplash.com/photo-1552664730-d307ca884978?w=800&h=800&fit=crop" alt="Consultoria e diagnÃ³stico empresarial" class="w-full h-full object-cover rounded-lg">
      </div>
      <div>
        <h1 class="text-4xl font-bold mb-2">Descubra onde sua empresa estÃ¡ perdendo tempo e dinheiro</h1>
        <p class="text-slate-600 mb-8">Preencha o formulÃ¡rio abaixo e receba uma anÃ¡lise personalizada.</p>
        <form id="contactForm" class="space-y-5">
          {% csrf_token %}
          <div>
            <label class="text-sm font-semibold text-slate-700 block mb-2">Nome completo</label>
            <input name="name" placeholder="Seu nome" class="input input-bordered w-full rounded-lg py-2.5" required>
          </div>
          <div>
            <label class="text-sm font-semibold text-slate-700 block mb-2">Empresa</label>
            <input name="company" placeholder="Nome da empresa" class="input input-bordered w-full rounded-lg py-2.5">
          </div>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="text-sm font-semibold text-slate-700 block mb-2">Cargo</label>
              <input name="role" placeholder="Seu cargo" class="input input-bordered w-full rounded-lg py-2.5">
            </div>
            <div>
              <label class="text-sm font-semibold text-slate-700 block mb-2">NÂº de colaboradores</label>
              <input name="employees_count" placeholder="Ex: 50" type="number" class="input input-bordered w-full rounded-lg py-2.5">
            </div>
          </div>
          <div>
            <label class="text-sm font-semibold text-slate-700 block mb-2">WhatsApp</label>
            <input name="whatsapp" placeholder="(11) 99999-9999" type="tel" class="input input-bordered w-full rounded-lg py-2.5">
          </div>
          <div>
            <label class="text-sm font-semibold text-slate-700 block mb-2">Principal desafio</label>
            <textarea name="main_challenge" placeholder="Descreva seu maior desafio operacional..." class="textarea textarea-bordered w-full rounded-lg py-2.5" rows="4"></textarea>
          </div>
          <div>
            <button type="submit" class="btn btn-md btn-primary px-8 py-3 text-base font-semibold w-full rounded-lg">Agendar diagnÃ³stico gratuito</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>

<!-- Modal de Sucesso -->
<dialog id="successModal" class="modal modal-bottom sm:modal-middle">
  <div class="modal-box bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-green-400 rounded-3xl p-8">
    <div class="flex justify-center mb-6">
      <div class="w-32 h-32 bg-white rounded-2xl flex items-center justify-center shadow-lg">
        <!-- IlustraÃ§Ã£o de Mascote Cartoon -->
        <svg class="w-24 h-24" viewBox="0 0 150 160" fill="none" xmlns="http://www.w3.org/2000/svg">
          <!-- CabeÃ§a -->
          <circle cx="75" cy="50" r="28" fill="#8B5CF6" stroke="#7C3AED" stroke-width="2"/>
          
          <!-- Olhos -->
          <circle cx="65" cy="45" r="6" fill="white"/>
          <circle cx="85" cy="45" r="6" fill="white"/>
          <circle cx="66" cy="46" r="3" fill="#7C3AED"/>
          <circle cx="86" cy="46" r="3" fill="#7C3AED"/>
          
          <!-- Boca sorridente -->
          <path d="M65 55Q75 60 85 55" stroke="#7C3AED" stroke-width="2" fill="none" stroke-linecap="round"/>
          
          <!-- Corpo -->
          <ellipse cx="75" cy="90" rx="22" ry="28" fill="#A78BFA" stroke="#8B5CF6" stroke-width="2"/>
          
          <!-- BraÃ§os -->
          <ellipse cx="50" cy="85" rx="12" ry="20" fill="#A78BFA" stroke="#8B5CF6" stroke-width="2" transform="rotate(-25 50 85)"/>
          <ellipse cx="100" cy="85" rx="12" ry="20" fill="#A78BFA" stroke="#8B5CF6" stroke-width="2" transform="rotate(25 100 85)"/>
          
          <!-- MÃ£os -->
          <circle cx="40" cy="75" r="8" fill="#DDD6FE" stroke="#8B5CF6" stroke-width="1.5"/>
          <circle cx="110" cy="75" r="8" fill="#DDD6FE" stroke="#8B5CF6" stroke-width="1.5"/>
          
          <!-- Pernas -->
          <rect x="65" y="115" width="10" height="25" rx="5" fill="#8B5CF6" stroke="#7C3AED" stroke-width="1.5"/>
          <rect x="75" y="115" width="10" height="25" rx="5" fill="#8B5CF6" stroke="#7C3AED" stroke-width="1.5"/>
          
          <!-- PÃ©s -->
          <ellipse cx="70" cy="145" rx="8" ry="6" fill="#DDD6FE" stroke="#8B5CF6" stroke-width="1.5"/>
          <ellipse cx="80" cy="145" rx="8" ry="6" fill="#DDD6FE" stroke="#8B5CF6" stroke-width="1.5"/>
          
          <!-- Estrela de aprovaÃ§Ã£o -->
          <g transform="translate(110, 30)">
            <polygon points="0,-8 2.5,-2.5 8,-1 3,2.5 5,8 0,4 -5,8 -3,2.5 -8,-1 -2.5,-2.5" fill="#FBBF24" stroke="#F59E0B" stroke-width="1"/>
          </g>
        </svg>
      </div>
    </div>
    
    <h3 class="font-bold text-2xl text-center mb-2 text-slate-800">Ã“timo! Recebemos seu contato ðŸŽ‰</h3>
    <p class="text-center text-slate-600 mb-6">Um especialista da Sumconnect jÃ¡ vai entrar em contato com vocÃª em instantes via WhatsApp.</p>
    
    <div class="bg-white rounded-2xl p-4 mb-6 border-l-4 border-blue-500 shadow-sm">
      <p class="text-sm text-slate-700"><strong>O que esperar:</strong></p>
      <ul class="text-sm text-slate-600 mt-2 space-y-1">
        <li>âœ“ AnÃ¡lise personalizada do seu negÃ³cio</li>
        <li>âœ“ Oportunidades de automaÃ§Ã£o</li>
        <li>âœ“ Sem compromisso ou custo</li>
      </ul>
    </div>
    
    <div class="modal-action">
      <button class="btn btn-primary w-full rounded-xl font-semibold" onclick="document.getElementById('successModal').close(); location.reload();">Voltar ao site</button>
    </div>
  </div>
  <form method="dialog" class="modal-backdrop"></form>
</dialog>

<script>
  document.getElementById('contactForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const submitButton = this.querySelector('button[type="submit"]');
    const originalText = submitButton.textContent;
    
    // Mostrar loading
    submitButton.disabled = true;
    submitButton.textContent = 'Enviando...';
    
    fetch('{% url "contact" %}', {
      method: 'POST',
      body: formData,
      headers: {
        'X-Requested-With': 'XMLHttpRequest',
      }
    })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        // Limpar formulÃ¡rio
        document.getElementById('contactForm').reset();
        // Mostrar modal
        document.getElementById('successModal').showModal();
      }
    })
    .catch(error => {
      console.error('Erro:', error);
      alert('Houve um erro ao enviar o formulÃ¡rio. Tente novamente.');
      submitButton.disabled = false;
      submitButton.textContent = originalText;
    })
    .finally(() => {
      submitButton.disabled = false;
      submitButton.textContent = originalText;
    });
  });
</script>
{% endblock %}
